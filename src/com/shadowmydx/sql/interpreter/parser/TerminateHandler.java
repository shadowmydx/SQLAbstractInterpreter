package com.shadowmydx.sql.interpreter.parser;

import com.shadowmydx.sql.interpreter.parser.terminate.*;

import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;

/**
 * Created by WULI5 on 6/29/2017.
 */
public class TerminateHandler {

    private static Set<String> keyword = new HashSet<String>();
    /*
     keyword url: https://docs.oracle.com/cd/B19306_01/appdev.102/b14354/appb.htm
     parse javascript code:
     var a = $('.cellalignment1453');
     for (var i = 0; i < a.length; i ++) {
     var current = a[i];
     for (var j = 0; j < current.tBodies.length; j ++) {
     for (var k = 0; k < current.tBodies[j].rows.length; k ++) {
     for (var p = 0; p < current.tBodies[j].rows[k].cells.length; p ++) {
     var pattern = 'keyword.add("<word>");'
     console.log(pattern.replace('<word>', current.tBodies[j].rows[k].cells[p].innerHTML));
     }
     }
     }
     }
    */
    static {
        keyword.add("ACCESS");
        keyword.add("ELSE");
        keyword.add("MODIFY");
        keyword.add("START");
        keyword.add("ADD");
        keyword.add("EXCLUSIVE");
        keyword.add("NOAUDIT");
        keyword.add("SELECT");
        keyword.add("ALL");
        keyword.add("EXISTS");
        keyword.add("NOCOMPRESS");
        keyword.add("SESSION");
        keyword.add("ALTER");
        keyword.add("FILE");
        keyword.add("NOT");
        keyword.add("SET");
        keyword.add("AND");
        keyword.add("FLOAT");
        keyword.add("NOTFOUND");
        keyword.add("SHARE");
        keyword.add("ANY");
        keyword.add("FOR");
        keyword.add("NOWAIT");
        keyword.add("SIZE");
        keyword.add("ARRAYLEN");
        keyword.add("FROM");
        keyword.add("NULL");
        keyword.add("SMALLINT");
        keyword.add("AS");
        keyword.add("GRANT");
        keyword.add("NUMBER");
        keyword.add("SQLBUF");
        keyword.add("ASC");
        keyword.add("GROUP");
        keyword.add("OF");
        keyword.add("SUCCESSFUL");
        keyword.add("AUDIT");
        keyword.add("HAVING");
        keyword.add("OFFLINE");
        keyword.add("SYNONYM");
        keyword.add("BETWEEN");
        keyword.add("IDENTIFIED");
        keyword.add("ON");
        keyword.add("SYSDATE");
        keyword.add("BY");
        keyword.add("IMMEDIATE");
        keyword.add("ONLINE");
        keyword.add("TABLE");
        keyword.add("CHAR");
        keyword.add("IN");
        keyword.add("OPTION");
        keyword.add("THEN");
        keyword.add("CHECK");
        keyword.add("INCREMENT");
        keyword.add("OR");
        keyword.add("TO");
        keyword.add("CLUSTER");
        keyword.add("INDEX");
        keyword.add("ORDER");
        keyword.add("TRIGGER");
        keyword.add("COLUMN");
        keyword.add("INITIAL");
        keyword.add("PCTFREE");
        keyword.add("UID");
        keyword.add("COMMENT");
        keyword.add("INSERT");
        keyword.add("PRIOR");
        keyword.add("UNION");
        keyword.add("COMPRESS");
        keyword.add("INTEGER");
        keyword.add("PRIVILEGES");
        keyword.add("UNIQUE");
        keyword.add("CONNECT");
        keyword.add("INTERSECT");
        keyword.add("PUBLIC");
        keyword.add("UPDATE");
        keyword.add("CREATE");
        keyword.add("INTO");
        keyword.add("RAW");
        keyword.add("USER");
        keyword.add("CURRENT");
        keyword.add("IS");
        keyword.add("RENAME");
        keyword.add("VALIDATE");
        keyword.add("DATE");
        keyword.add("LEVEL");
        keyword.add("RESOURCE");
        keyword.add("VALUES");
        keyword.add("DECIMAL");
        keyword.add("LIKE");
        keyword.add("REVOKE");
        keyword.add("VARCHAR");
        keyword.add("DEFAULT");
        keyword.add("LOCK");
        keyword.add("ROW");
        keyword.add("VARCHAR2");
        keyword.add("DELETE");
        keyword.add("LONG");
        keyword.add("ROWID");
        keyword.add("VIEW");
        keyword.add("DESC");
        keyword.add("MAXEXTENTS");
        keyword.add("ROWLABEL");
        keyword.add("WHENEVER");
        keyword.add("DISTINCT");
        keyword.add("MINUS");
        keyword.add("ROWNUM");
        keyword.add("WHERE");
        keyword.add("DROP");
        keyword.add("MODE");
        keyword.add("ROWS");
        keyword.add("WITH");
        keyword.add("ADMIN");
        keyword.add("CURSOR");
        keyword.add("FOUND");
        keyword.add("MOUNT");
        keyword.add("AFTER");
        keyword.add("CYCLE");
        keyword.add("FUNCTION");
        keyword.add("NEXT");
        keyword.add("ALLOCATE");
        keyword.add("DATABASE");
        keyword.add("GO");
        keyword.add("NEW");
        keyword.add("ANALYZE");
        keyword.add("DATAFILE");
        keyword.add("GOTO");
        keyword.add("NOARCHIVELOG");
        keyword.add("ARCHIVE");
        keyword.add("DBA");
        keyword.add("GROUPS");
        keyword.add("NOCACHE");
        keyword.add("ARCHIVELOG");
        keyword.add("DEC");
        keyword.add("INCLUDING");
        keyword.add("NOCYCLE");
        keyword.add("AUTHORIZATION");
        keyword.add("DECLARE");
        keyword.add("INDICATOR");
        keyword.add("NOMAXVALUE");
        keyword.add("AVG");
        keyword.add("DISABLE");
        keyword.add("INITRANS");
        keyword.add("NOMINVALUE");
        keyword.add("BACKUP");
        keyword.add("DISMOUNT");
        keyword.add("INSTANCE");
        keyword.add("NONE");
        keyword.add("BEGIN");
        keyword.add("DOUBLE");
        keyword.add("INT");
        keyword.add("NOORDER");
        keyword.add("BECOME");
        keyword.add("DUMP");
        keyword.add("KEY");
        keyword.add("NORESETLOGS");
        keyword.add("BEFORE");
        keyword.add("EACH");
        keyword.add("LANGUAGE");
        keyword.add("NORMAL");
        keyword.add("BLOCK");
        keyword.add("ENABLE");
        keyword.add("LAYER");
        keyword.add("NOSORT");
        keyword.add("BODY");
        keyword.add("END");
        keyword.add("LINK");
        keyword.add("NUMERIC");
        keyword.add("CACHE");
        keyword.add("ESCAPE");
        keyword.add("LISTS");
        keyword.add("OFF");
        keyword.add("CANCEL");
        keyword.add("EVENTS");
        keyword.add("LOGFILE");
        keyword.add("OLD");
        keyword.add("CASCADE");
        keyword.add("EXCEPT");
        keyword.add("MANAGE");
        keyword.add("ONLY");
        keyword.add("CHANGE");
        keyword.add("EXCEPTIONS");
        keyword.add("MANUAL");
        keyword.add("OPEN");
        keyword.add("CHARACTER");
        keyword.add("EXEC");
        keyword.add("MAX");
        keyword.add("OPTIMAL");
        keyword.add("CHECKPOINT");
        keyword.add("EXPLAIN");
        keyword.add("MAXDATAFILES");
        keyword.add("OWN");
        keyword.add("CLOSE");
        keyword.add("EXECUTE");
        keyword.add("MAXINSTANCES");
        keyword.add("PACKAGE");
        keyword.add("COBOL");
        keyword.add("EXTENT");
        keyword.add("MAXLOGFILES");
        keyword.add("PARALLEL");
        keyword.add("COMMIT");
        keyword.add("EXTERNALLY");
        keyword.add("MAXLOGHISTORY");
        keyword.add("PCTINCREASE");
        keyword.add("COMPILE");
        keyword.add("FETCH");
        keyword.add("MAXLOGMEMBERS");
        keyword.add("PCTUSED");
        keyword.add("CONSTRAINT");
        keyword.add("FLUSH");
        keyword.add("MAXTRANS");
        keyword.add("PLAN");
        keyword.add("CONSTRAINTS");
        keyword.add("FREELIST");
        keyword.add("MAXVALUE");
        keyword.add("PLI");
        keyword.add("CONTENTS");
        keyword.add("FREELISTS");
        keyword.add("MIN");
        keyword.add("PRECISION");
        keyword.add("CONTINUE");
        keyword.add("FORCE");
        keyword.add("MINEXTENTS");
        keyword.add("PRIMARY");
        keyword.add("CONTROLFILE");
        keyword.add("FOREIGN");
        keyword.add("MINVALUE");
        keyword.add("PRIVATE");
        keyword.add("COUNT");
        keyword.add("FORTRAN");
        keyword.add("MODULE");
        keyword.add("PROCEDURE");
        keyword.add("PROFILE");
        keyword.add("SAVEPOINT");
        keyword.add("SQLSTATE");
        keyword.add("TRACING");
        keyword.add("QUOTA");
        keyword.add("SCHEMA");
        keyword.add("STATEMENT_ID");
        keyword.add("TRANSACTION");
        keyword.add("READ");
        keyword.add("SCN");
        keyword.add("STATISTICS");
        keyword.add("TRIGGERS");
        keyword.add("REAL");
        keyword.add("SECTION");
        keyword.add("STOP");
        keyword.add("TRUNCATE");
        keyword.add("RECOVER");
        keyword.add("SEGMENT");
        keyword.add("STORAGE");
        keyword.add("UNDER");
        keyword.add("REFERENCES");
        keyword.add("SEQUENCE");
        keyword.add("SUM");
        keyword.add("UNLIMITED");
        keyword.add("REFERENCING");
        keyword.add("SHARED");
        keyword.add("SWITCH");
        keyword.add("UNTIL");
        keyword.add("RESETLOGS");
        keyword.add("SNAPSHOT");
        keyword.add("SYSTEM");
        keyword.add("USE");
        keyword.add("RESTRICTED");
        keyword.add("SOME");
        keyword.add("TABLES");
        keyword.add("USING");
        keyword.add("REUSE");
        keyword.add("SORT");
        keyword.add("TABLESPACE");
        keyword.add("WHEN");
        keyword.add("ROLE");
        keyword.add("SQL");
        keyword.add("TEMPORARY");
        keyword.add("WRITE");
        keyword.add("ROLES");
        keyword.add("SQLCODE");
        keyword.add("THREAD");
        keyword.add("WORK");
        keyword.add("ROLLBACK");
        keyword.add("SQLERROR");
        keyword.add("TIME");
        keyword.add("ABORT");
        keyword.add("BETWEEN");
        keyword.add("CRASH");
        keyword.add("DIGITS");
        keyword.add("ACCEPT");
        keyword.add("BINARY_INTEGER");
        keyword.add("CREATE");
        keyword.add("DISPOSE");
        keyword.add("ACCESS");
        keyword.add("BODY");
        keyword.add("CURRENT");
        keyword.add("DISTINCT");
        keyword.add("ADD");
        keyword.add("BOOLEAN");
        keyword.add("CURRVAL");
        keyword.add("DO");
        keyword.add("ALL");
        keyword.add("BY");
        keyword.add("CURSOR");
        keyword.add("DROP");
        keyword.add("ALTER");
        keyword.add("CASE");
        keyword.add("DATABASE");
        keyword.add("ELSE");
        keyword.add("AND");
        keyword.add("CHAR");
        keyword.add("DATA_BASE");
        keyword.add("ELSIF");
        keyword.add("ANY");
        keyword.add("CHAR_BASE");
        keyword.add("DATE");
        keyword.add("END");
        keyword.add("ARRAY");
        keyword.add("CHECK");
        keyword.add("DBA");
        keyword.add("ENTRY");
        keyword.add("ARRAYLEN");
        keyword.add("CLOSE");
        keyword.add("DEBUGOFF");
        keyword.add("EXCEPTION");
        keyword.add("AS");
        keyword.add("CLUSTER");
        keyword.add("DEBUGON");
        keyword.add("EXCEPTION_INIT");
        keyword.add("ASC");
        keyword.add("CLUSTERS");
        keyword.add("DECLARE");
        keyword.add("EXISTS");
        keyword.add("ASSERT");
        keyword.add("COLAUTH");
        keyword.add("DECIMAL");
        keyword.add("EXIT");
        keyword.add("ASSIGN");
        keyword.add("COLUMNS");
        keyword.add("DEFAULT");
        keyword.add("FALSE");
        keyword.add("AT");
        keyword.add("COMMIT");
        keyword.add("DEFINITION");
        keyword.add("FETCH");
        keyword.add("AUTHORIZATION");
        keyword.add("COMPRESS");
        keyword.add("DELAY");
        keyword.add("FLOAT");
        keyword.add("AVG");
        keyword.add("CONNECT");
        keyword.add("DELETE");
        keyword.add("FOR");
        keyword.add("BASE_TABLE");
        keyword.add("CONSTANT");
        keyword.add("DELTA");
        keyword.add("FORM");
        keyword.add("BEGIN");
        keyword.add("COUNT");
        keyword.add("DESC");
        keyword.add("FROM");
        keyword.add("FUNCTION");
        keyword.add("NEW");
        keyword.add("RELEASE");
        keyword.add("SUM");
        keyword.add("GENERIC");
        keyword.add("NEXTVAL");
        keyword.add("REMR");
        keyword.add("TABAUTH");
        keyword.add("GOTO");
        keyword.add("NOCOMPRESS");
        keyword.add("RENAME");
        keyword.add("TABLE");
        keyword.add("GRANT");
        keyword.add("NOT");
        keyword.add("RESOURCE");
        keyword.add("TABLES");
        keyword.add("GROUP");
        keyword.add("NULL");
        keyword.add("RETURN");
        keyword.add("TASK");
        keyword.add("HAVING");
        keyword.add("NUMBER");
        keyword.add("REVERSE");
        keyword.add("TERMINATE");
        keyword.add("IDENTIFIED");
        keyword.add("NUMBER_BASE");
        keyword.add("REVOKE");
        keyword.add("THEN");
        keyword.add("IF");
        keyword.add("OF");
        keyword.add("ROLLBACK");
        keyword.add("TO");
        keyword.add("IN");
        keyword.add("ON");
        keyword.add("ROWID");
        keyword.add("TRUE");
        keyword.add("INDEX");
        keyword.add("OPEN");
        keyword.add("ROWLABEL");
        keyword.add("TYPE");
        keyword.add("INDEXES");
        keyword.add("OPTION");
        keyword.add("ROWNUM");
        keyword.add("UNION");
        keyword.add("INDICATOR");
        keyword.add("OR");
        keyword.add("ROWTYPE");
        keyword.add("UNIQUE");
        keyword.add("INSERT");
        keyword.add("ORDER");
        keyword.add("RUN");
        keyword.add("UPDATE");
        keyword.add("INTEGER");
        keyword.add("OTHERS");
        keyword.add("SAVEPOINT");
        keyword.add("USE");
        keyword.add("INTERSECT");
        keyword.add("OUT");
        keyword.add("SCHEMA");
        keyword.add("VALUES");
        keyword.add("INTO");
        keyword.add("PACKAGE");
        keyword.add("SELECT");
        keyword.add("VARCHAR");
        keyword.add("IS");
        keyword.add("PARTITION");
        keyword.add("SEPARATE");
        keyword.add("VARCHAR2");
        keyword.add("LEVEL");
        keyword.add("PCTFREE");
        keyword.add("SET");
        keyword.add("VARIANCE");
        keyword.add("LIKE");
        keyword.add("POSITIVE");
        keyword.add("SIZE");
        keyword.add("VIEW");
        keyword.add("LIMITED");
        keyword.add("PRAGMA");
        keyword.add("SMALLINT");
        keyword.add("VIEWS");
        keyword.add("LOOP");
        keyword.add("PRIOR");
        keyword.add("SPACE");
        keyword.add("WHEN");
        keyword.add("MAX");
        keyword.add("PRIVATE");
        keyword.add("SQL");
        keyword.add("WHERE");
        keyword.add("MIN");
        keyword.add("PROCEDURE");
        keyword.add("SQLCODE");
        keyword.add("WHILE");
        keyword.add("MINUS");
        keyword.add("PUBLIC");
        keyword.add("SQLERRM");
        keyword.add("WITH");
        keyword.add("MLSLABEL");
        keyword.add("RAISE");
        keyword.add("START");
        keyword.add("WORK");
        keyword.add("MOD");
        keyword.add("RANGE");
        keyword.add("STATEMENT");
        keyword.add("XOR");
        keyword.add("MODE");
        keyword.add("REAL");
        keyword.add("STDDEV");
        keyword.add("NATURAL");
        keyword.add("RECORD");
        keyword.add("SUBTYPE");
    }

    private static Map<String, Handler> terminate = new HashMap<String, Handler> ();

    static {
        terminate.put("TABLE_NAME", new IdentifierHandler());
        terminate.put("COLUMN_NAME", new IdentifierHandler());
        terminate.put("USER_NAME", new IdentifierHandler());
        terminate.put("DIGIT", new DigitHandler());
        terminate.put("NORMAL_STRING", new StringHandler());
    }

    public static boolean judge(String treeTerminate, String token) {
        Handler handler = terminate.get(treeTerminate);
        if (handler == null) {
            handler = new DefaultHandler();
        }
        return handler.execute(treeTerminate, token);
    }

    public static boolean isKeyword(String token) {
        return keyword.contains(token);
    }
}
